{% extends "base.html" %}
{% block content %}

<article class="episode-page">
  <header class="episode-page-header">
    {% if ep.image %}
      <img src="{{ ep.image }}" alt="{{ ep.title }} cover art" class="episode-page-art">
    {% endif %}
    <div class="episode-page-meta">
      <h1>{{ ep.title }}</h1>
      <p class="date">{{ ep.published | date("%b %d, %Y") }}</p>
      {% if ep.subtitle %}
        <p class="subtitle">{{ ep.subtitle }}</p>
      {% endif %}
      {% if ep.audio %}
        <audio controls class="episode-audio" id="episode-audio">
          <source src="{{ ep.audio }}">
          Your browser does not support the audio element.
        </audio>
      {% endif %}
    </div>
  </header>

  <section class="episode-main">
    {% set page = ep.page or {} %}

    {% if page.hosts %}
      <div class="people-block">
        <h2>Hosts</h2>
        <ul>
          {% for h in page.hosts %}
            <li>
              {% if h.url %}
                <a href="{{ h.url }}" target="_blank" rel="noopener">{{ h.name }}</a>
              {% else %}
                {{ h.name }}
              {% endif %}
            </li>
          {% endfor %}
        </ul>
      </div>
    {% endif %}

    {% if page.guests %}
      <div class="people-block">
        <h2>Guests</h2>
        <ul>
          {% for g in page.guests %}
            <li>
              {% if g.url %}
                <a href="{{ g.url }}" target="_blank" rel="noopener">{{ g.name }}</a>
              {% else %}
                {{ g.name }}
              {% endif %}
            </li>
          {% endfor %}
        </ul>
      </div>
    {% endif %}

    {% if page.comments %}
      <div class="epi-comments">
        <h2>Notes</h2>
        <ul>
          {% for c in page.comments %}
            <li>{{ c }}</li>
          {% endfor %}
        </ul>
      </div>
    {% endif %}

    <div class="epi-description">
      {{ ep.content | safe }}
    </div>

    {% if page.transcript_html %}
      <section class="epi-transcript" id="transcript">
        <div class="transcript-header">
          <h2>Transcript</h2>
          <button
            type="button"
            id="toggle-timecodes"
            class="btn btn-small"
            aria-pressed="false"
            aria-label="Show timestamps in transcript"
          >
            Show timestamps
          </button>
        </div>
        <div class="transcript-body">
          {{ page.transcript_html | safe }}
        </div>
      </section>
    {% elif ep.transcript_url %}
      <section class="epi-transcript">
        <h2>Transcript</h2>
        <p>
          <a href="{{ ep.transcript_url }}" target="_blank" rel="noopener">
            View transcript
          </a>
        </p>
      </section>
    {% endif %}
  </section>
</article>

{% endblock %}
